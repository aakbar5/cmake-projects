# CMAKE Samples

<!-- TOC -->

- [CMAKE Samples](#cmake-samples)
- [Description](#description)
- [Samples](#samples)
    - [-app](#-app)
    - [-library](#-library)
    - [-external_libs](#-external_libs)
    - [-misc](#-misc)
- [TODOs](#todos)
- [Tips](#tips)
    - [Set a variable](#set-a-variable)
    - [Print general info](#print-general-info)
    - [Show all variables](#show-all-variables)
    - [Generate targets](#generate-targets)
    - [Generate compiler files](#generate-compiler-files)

<!-- /TOC -->

# Description
CMake examples of daily use.

# Samples

## 01-app
Single file to multiple files application alongwith setting up a specific version of CXX version.

-  [101](01-app/101/CMakeLists.txt):
   - A very basic cmake application.

-  [102](01-app/102/CMakeLists.txt):
   - A very basic cmake application with an option to set build type.

-  [103](01-app/103/CMakeLists.txt):
   - Hello world app to instruct where to install executables.

-  [104](01-app/104/CMakeLists.txt):
   - Build & install application having multiple source files.

-  [105](01-app/105/CMakeLists.txt):
   - Build & install application having multiple sources files + private header.

-  [106](01-app/106/CMakeLists.txt):
   - Build & install application having multiple sources files + private header + version file generated by cmake template.

-  [107](01-app/107/CMakeLists.txt):
   - A hello-world of std::cxx14.

## 02-library
Create static and shared libraries and how to use these libraries with application in different ways.

-  [201](02-library/201/CMakeLists.txt):
   - A static library using std::cxx14.

-  [202](02-library/202/CMakeLists.txt):
   - A shared library using std::cxx14.
   - Also see [211](02-library/211/CMakeLists.txt)

-  [203](02-library/203/CMakeLists.txt):
   - An application using a static library (direct linking).

-  [204](02-library/204/CMakeLists.txt):
   - An application using a shared library (direct linking).

-  [205](02-library/205/CMakeLists.txt):
   - An application using a libary via `.pc` (using `pkg-config`)
   - `pkg-config` can be referred to static or shared library.

-  [206](02-library/206/CMakeLists.txt):
   - Generate .cmake file for a library (static).

-  [207](02-library/207/CMakeLists.txt):
   - An application using a static library (using `.cmake`).
   - TODO: Inherit compiler specific flags from library just like `pkg-config` can do that.

-  [208](02-library/208/CMakeLists.txt):
   - Generate `.cmake` file for a library (shared library).

-  [209](02-library/209/CMakeLists.txt):
   - An application using a shared library (using `.cmake`).
   - TODO: Inherit compiler specific flags from library just like `pkg-config` can do that.

-  [210](02-library/210/CMakeLists.txt):
   - A single project to build shared and static lib (`pkg-config`, `.cmake`).

-  [211](02-library/211/CMakeLists.txt):
   - An enhanced version of [202](02-library/202/CMakeLists.txt). Generator expressions are used.

## 03-external_libs
Use 3rd party libraries in an application.

-  [301](03-external_libs/301/CMakeLists.txt):
   - A hello-world using cmake.BOOST.

## 04-misc
Miscellaneous usages.

-  [401](04-misc/401/CMakeLists.txt):
   - Application packaging using cpack.

-  [402](04-misc/402/CMakeLists.txt):
   - How to use cmake custom command and target interfaces.
      - `add_custom_command` links to different stages of build `PRE_BUILD`, `PRE_LINK`, `POST_BUILD`
      - Link `add_custom_command` with custom target.

-  [403](04-misc/403/CMakeLists.txt):
   - ExternalProject: Create custom targets to build projects in external trees.

-  [404](04-misc/404/CMakeLists.txt):
   - ExternalProject: Pull GoogleTest (gtest) as cmake external project.

# TODOs
- Linking of protobuf, flatbuffers and nanopb via cmake.

# Tips

## Set a variable
```bash
set(TEST_VAR "value")               # Overwrite old value if it set
set(TEST_VAR "${TEST_VAR} value")   # Append  new value to old
```

## Print general info
```bash
message("-----------------------------------------------------------")
message("Lib Version            : ${VERSION_STRING}")
message("Compiler Id            : ${CMAKE_CXX_COMPILER_ID}")
message("Compiler (c) version   : ${CMAKE_C_COMPILER_VERSION}")
message("Compiler (cxx) version : ${CMAKE_CXX_COMPILER_VERSION}")
message("-----------------------------------------------------------")
```

## Show all variables
```bash
##
message("+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++")
# Get all variables as a list
get_cmake_property(varList VARIABLES)

# Filter variable to have only those starting with our required package
list(FILTER varList INCLUDE REGEX "^sample_lib*")
message("Variables associated to sample_lib are: ")
foreach (_variableName ${varList})
    message("    ${_variableName}=${${_variableName}}")
endforeach()
message("+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++")
##
```

## Generate targets
- Show all targets generated by cmake for a project
```bash
cmake --build /path/to/build/folder --target help
```

- Run a specific target
```bash
cmake --build /path/to/build/folder --target <target_name>
```

## Generate compiler files
- Save compiler intermediate files
```bash
set (CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} --save-temps")
```
